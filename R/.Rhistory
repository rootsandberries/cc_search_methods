mutate(grey_list = case_when(
grey_list == "all" ~ "yes",
grey_list == "some" ~ "some",
grey_list == "none" ~ "no",
TRUE ~ as.character(grey_list)  # Keep other values unchanged
))
ccmethods_data_is_sub <- ccmethods_data_is_sub %>%
mutate(grey_search = case_when(
grey_search == "General grey literature approach stated in text only" ~ "some",
grey_search == "All exact search strategies reported" ~ "yes",
grey_search == "No reporting of how grey literature was searched" ~ "no",
grey_search == "Some exact search strategies reported" ~ "yes",
TRUE ~ as.character(grey_search)  # Keep other values unchanged
))
ccmethods_data_is_sub <- ccmethods_data_is_sub %>%
mutate(free_search = case_when(
free_search == "list of search terms provided but not exact strategy" ~ "some",
free_search == "list of search terms provided but not exact strategy and number of pages/results screened reported" ~ "some",
free_search == "exact search strategy/strategies reported" ~ "yes",
free_search == "No details given" ~ "no",
free_search == "exact search strategy/strategies reported and number of pages/results screened reported" ~ "yes",
TRUE ~ as.character(free_search)  # Keep other values unchanged
))
ccmethods_data_is_sub <- ccmethods_data_is_sub %>%
mutate(engine_search = case_when(
engine_search == "list of search terms provided but not exact strategy" ~ "some",
engine_search == "list of search terms provided but not exact strategy and number of pages/results screened reported" ~ "some",
engine_search == "exact search strategy/strategies reported" ~ "yes",
engine_search == "No details given" ~ "no",
engine_search == "exact search strategy/strategies reported and number of pages/results screened reported" ~ "yes",
TRUE ~ as.character(free_search)  # Keep other values unchanged
))
ccmethods_data_is_sub <- ccmethods_data_is_sub %>%
mutate(db_list_gp = case_when(
db_list_gp == "all" ~ "yes",
db_list_gp == "some" ~ "some",
db_list_gp == "none" ~ "no",
TRUE ~ as.character(db_list_gp)  # Keep other values unchanged
))
##Table of conduct variables by IS involvement----
##Create tables of percentage compliance by IS involvement.
#Is a co-author
ccmethods_IS_coauthor <- ccmethods_data_is_sub %>% filter(infosp_coauthor == 'yes')
#Percentages
coauthor_impact_per <- ccmethods_IS_coauthor %>%
summarise(across(everything(), ~ mean(. == 'yes', na.rm = TRUE) * 100, .names = '{.col}')) %>%
pivot_longer(everything(), names_to = "variable", values_to = "percentage") %>%
mutate(percentage = round(percentage, 1))
#write.csv(coauthor_impact_per, "coauthor_impact_per.csv")
#Counts
coauthor_impact_count <- colSums(ccmethods_IS_coauthor == "yes", na.rm = TRUE)
coauthor_impact_count_df <- data.frame(variable = names(coauthor_impact_count), count = coauthor_impact_count)
#write.csv(coauthor_impact_count_df, "coauthor_impact_count.csv")
#Combine percentage and counts tables by variable name
coauthor_impact <- merge(coauthor_impact_count_df, coauthor_impact_per, by = 'variable', all = TRUE)
#Was mentioned in methods or acknowledgment, but not co-author
ccmethods_IS_mention <- ccmethods_data_is_sub %>% filter(infosp_involve == 'yes', infosp_coauthor == 'no')
#Percentages
mention_impact_per <- ccmethods_IS_mention %>%
summarise(across(everything(), ~ mean(. == 'yes', na.rm = TRUE) * 100, .names = '{.col}')) %>%
pivot_longer(everything(), names_to = "variable", values_to = "percentage") %>%
mutate(percentage = round(percentage, 1))
#write.csv(mention_impact, "mention_impact.csv")
#Counts
mention_impact_count <- colSums(ccmethods_IS_mention == "yes", na.rm = TRUE)
mention_impact_count_df <- data.frame(variable = names(mention_impact_count), count = mention_impact_count)
#write.csv(mention_impact_count_df, "mention_impact_count.csv")
#Combine percentage and counts tables by variable name
mention_impact <- merge(mention_impact_count_df, mention_impact_per, by = 'variable', all = TRUE)
#Is involved in some way
ccmethods_IS_involve <- ccmethods_data_is_sub %>% filter(infospec == 'yes')
#Percentage
involve_impact_per <- ccmethods_IS_involve %>%
summarise(across(everything(), ~ mean(. == 'yes', na.rm = TRUE) * 100, .names = '{.col}')) %>%
pivot_longer(everything(), names_to = "variable", values_to = "percentage") %>%
mutate(percentage = round(percentage, 1))
#write.csv(involve_impact, "involve_impact.csv")
#Is not an author
ccmethods_IS_no_author <- ccmethods_data_is_sub %>% filter(infosp_coauthor == 'no')
#Percentages
no_author_impact_per <- ccmethods_IS_no_author %>%
summarise(across(everything(), ~ mean(. == 'yes', na.rm = TRUE) * 100, .names = '{.col}')) %>%
pivot_longer(everything(), names_to = "variable", values_to = "percentage") %>%
mutate(percentage = round(percentage, 1))
#write.csv(no_author_impact, "no_author_impact.csv")
#No involvement at all
ccmethods_IS_none <- ccmethods_data_is_sub %>% filter(infospec == 'no')
#Percentages
none_impact_per <- ccmethods_IS_none %>%
summarise(across(everything(), ~ mean(. == 'yes', na.rm = TRUE) * 100, .names = '{.col}')) %>%
pivot_longer(everything(), names_to = "variable", values_to = "percentage") %>%
mutate(percentage = round(percentage, 1))
#write.csv(none_impact, "none_impact.csv")
#Count
none_impact_count <- colSums(ccmethods_IS_none == "yes", na.rm = TRUE)
none_impact_count_df <- data.frame(variable = names(none_impact_count), count = none_impact_count)
#write.csv(none_impact_count_df, "none_impact_count.csv")
#Combine percentage and counts tables by variable name
none_impact <- merge(none_impact_count_df, none_impact_per, by = 'variable', all = TRUE)
#Total percent of each variable with yes value
percent_yes <- ccmethods_data_is_sub %>%
summarise(across(everything(), ~ mean(. == 'yes', na.rm = TRUE) * 100, .names = 'Percent_{.col}')) %>%
pivot_longer(everything(), names_to = "Variable", values_to = "Percentage") %>%
mutate(Percentage = round(Percentage, 1))
#write.csv(percent_yes, "percent_yes.csv")
#A
report_coauth <- coauthor_impact %>% filter(variable == "strategy_all"|
variable == "db_list_gp"|
variable == "db_platform"|
variable == "date_searches"|
variable == "grey_list"|
variable == "grey_search"|
variable == "grey_url"|
variable == "forward_method"|
variable == "refman_software"|
variable == "deduplicate"|
variable == "num_records")
report_mention <- mention_impact %>% filter(variable == "strategy_all"|
variable == "db_list_gp"|
variable == "db_platform"|
variable == "date_searches"|
variable == "grey_list"|
variable == "grey_search"|
variable == "grey_url"|
variable == "forward_method"|
variable == "refman_software"|
variable == "deduplicate"|
variable == "num_records")
#Report variables for no IS
#Report variables for IS coauthor
report_nois <- none_impact %>% filter(variable == "strategy_all"|
variable == "db_list_gp"|
variable == "db_platform"|
variable == "date_searches"|
variable == "grey_list"|
variable == "grey_search"|
variable == "grey_url"|
variable == "forward_method"|
variable == "refman_software"|
variable == "deduplicate"|
variable == "num_records")
#Merge all three dataframes
report_is_table1 <- merge(report_nois, report_mention, by = "variable", all = TRUE)
report_is_table <- merge(report_is_table1, report_coauth, by = "variable", all = TRUE)
#Recode variable names for table
report_is_table_rename <- report_is_table %>%
mutate(variable = case_when(
variable == "date_searches" ~ "Search dates reported",
variable == "db_list_gp" ~ "All databases and sub-databases listed",
variable == "db_platform" ~ "Database platform reported",
variable == "deduplicate" ~ "Deduplication method reported",
variable == "forward_method" ~ "Method for forward citation searching described",
variable == "grey_list" ~ "Grey lit sources listed",
variable == "grey_search" ~ "Grey lit search reported",
variable == "grey_url" ~ "Grey lit URLs reported",
variable == "refman_software" ~ "Reference management software reported",
variable == "strategy_all" ~ "All search strategies reported",
variable == "num_records" ~ "Number of records per database reported"
))
#Reorder with custom order
report_custom_order <- c("All search strategies reported","All databases and sub-databases listed","Database platform reported",
"Search dates reported", "Grey lit sources listed", "Grey lit search reported",
"Grey lit URLs reported", "Method for forward citation searching described",
"Reference management software reported", "Deduplication method reported",
"Number of records per database reported")
report_is_table_rename <- report_is_table_rename %>%
mutate(variable = factor(variable, levels = report_custom_order)) %>%
arrange(variable)
write_csv(report_is_table_rename, here("./data_outputs/ccmethods_isinvolve_report_table.csv"))
##Figure 7B. Line graph for IS impact on reporting variables----
#Subset only percentage columns from conduct_is_table
report_is_chart_df <- report_is_table[, c(1,3, 5, 7)]
report_is_chart_long <- report_is_chart_df %>%
pivot_longer(cols = c(percentage.x, percentage.y, percentage),
names_to = "group",
values_to = "percentage")
report_is_chart_long <- report_is_chart_long %>%
mutate(group = case_when(
group == "percentage.x" ~ "No IS",
group == "percentage.y" ~ "IS consulted",
group == "percentage" ~ "IS co-author"))
report_is_chart_long <- report_is_chart_long %>%
mutate(group = factor(group, levels = c("No IS", "IS consulted", "IS co-author")))
#Recode variable names for chart legend
report_is_chart_renamed <- report_is_chart_long %>%
mutate(variable = case_when(
variable == "date_searches" ~ "Search dates",
variable == "db_list_gp" ~ "Database names",
variable == "db_platform" ~ "Database platform",
variable == "deduplicate" ~ "Dedup method",
variable == "forward_method" ~ "Forward citation method",
variable == "grey_list" ~ "Grey lit sources",
variable == "grey_search" ~ "Grey lit search",
variable == "grey_url" ~ "Grey lit URLs",
variable == "refman_software" ~ "Ref mgmt software",
variable == "strategy_all" ~ "All search strategies",
variable == "num_records" ~ "Number of database results"
))
#Reorder so that the legend list matches the order of values in the No IS column
custom_order_isrp <- c("Grey lit sources", "Search dates", "Forward citation method", "Database names", "Database platform", "Ref mgmt software", "All search strategies", "Grey lit search", "Number of database results", "Grey lit URLs", "Dedup method")
report_is_chart_renamed$variable <- factor(report_is_chart_renamed$variable, levels = custom_order_isrp)
#Create distinguishable palette for 11 variables
my_palette_11 <- c25 <- c(
"#E31A1C", # red
"green4",
"#6A3D9A", # purple
"#FF7F00", # orange
"black", "gold1", "deeppink1", "blue1",
"darkturquoise", "green1", "brown"
)
#Plot change in percentage over groups
pt_report_is <- ggplot(report_is_chart_renamed, aes(x = group, y = percentage, color = variable, group = variable)) +
geom_line() +
geom_point() +
guides(fill = guide_legend(title = NULL)) +
labs(title = "",
x = "",
y = "Percent of reviews",
color = "Variable") +
theme_minimal() +
theme(legend.title=element_blank()) +
scale_color_manual(values = my_palette_14) #+
my_palette_14 <- c25 <- c(
"dodgerblue2", "#E31A1C", # red
"green4",
"#6A3D9A", # purple
"#FF7F00", # orange
"black", "gold1", "orchid1", "deeppink1", "blue1",
"darkturquoise", "green1", "yellow3", "brown"
)
report_is_chart_df <- report_is_table[, c(1,3, 5, 7)]
#Transpose to long format grouping percentage columns by IS involvement
report_is_chart_long <- report_is_chart_df %>%
pivot_longer(cols = c(percentage.x, percentage.y, percentage),
names_to = "group",
values_to = "percentage")
#Rename group names
report_is_chart_long <- report_is_chart_long %>%
mutate(group = case_when(
group == "percentage.x" ~ "No IS",
group == "percentage.y" ~ "IS consulted",
group == "percentage" ~ "IS co-author"))
report_is_chart_long <- report_is_chart_long %>%
mutate(group = factor(group, levels = c("No IS", "IS consulted", "IS co-author")))
#Recode variable names for chart legend
report_is_chart_renamed <- report_is_chart_long %>%
mutate(variable = case_when(
variable == "date_searches" ~ "Search dates",
variable == "db_list_gp" ~ "Database names",
variable == "db_platform" ~ "Database platform",
variable == "deduplicate" ~ "Dedup method",
variable == "forward_method" ~ "Forward citation method",
variable == "grey_list" ~ "Grey lit sources",
variable == "grey_search" ~ "Grey lit search",
variable == "grey_url" ~ "Grey lit URLs",
variable == "refman_software" ~ "Ref mgmt software",
variable == "strategy_all" ~ "All search strategies",
variable == "num_records" ~ "Number of database results"
))
#Reorder so that the legend list matches the order of values in the No IS column
custom_order_isrp <- c("Grey lit sources", "Search dates", "Forward citation method", "Database names", "Database platform", "Ref mgmt software", "All search strategies", "Grey lit search", "Number of database results", "Grey lit URLs", "Dedup method")
report_is_chart_renamed$variable <- factor(report_is_chart_renamed$variable, levels = custom_order_isrp)
#Create distinguishable palette for 11 variables
my_palette_11 <- c25 <- c(
"#E31A1C", # red
"green4",
"#6A3D9A", # purple
"#FF7F00", # orange
"black", "gold1", "deeppink1", "blue1",
"darkturquoise", "green1", "brown"
)
#Plot change in percentage over groups
pt_report_is <- ggplot(report_is_chart_renamed, aes(x = group, y = percentage, color = variable, group = variable)) +
geom_line() +
geom_point() +
guides(fill = guide_legend(title = NULL)) +
labs(title = "",
x = "",
y = "Percent of reviews",
color = "Variable") +
theme_minimal() +
theme(legend.title=element_blank()) +
scale_color_manual(values = my_palette_14) #+
#theme(text = element_text(size=13))
ggsave(here("./plots/fig7b.png"), plot = pt_report_is, width = 6, height = 4, units = "in", dpi = 300)
pt_conduct_is <- ggplot(conduct_is_chart_renamed, aes(x = group, y = percentage, color = variable, group = variable)) +
geom_line() +
geom_point() +
labs(title = "",
x = "",
y = "Percent of reviews",
color = "Variable") +
theme_minimal() +
theme(legend.title=element_blank()) +
scale_color_manual(values = my_palette_14)
conduct_coauth <- coauthor_impact %>% filter(variable == "boolean"|
variable == "subhead"|
variable == "keyword_var"|
variable == "phrase"|
variable == "syntax"|
variable == "free_gs"|
variable == "engine_google"|
variable == "handsearch"|
variable == "experts"|
variable == "backward"|
variable == "forward"|
variable == "reviews"|
variable == "update_search"|
variable == "kugley")
#Conduct variables for IS mention
conduct_mention <- mention_impact %>% filter(variable == "boolean"|
variable == "subhead"|
variable == "keyword_var"|
variable == "phrase"|
variable == "syntax"|
variable == "free_gs"|
variable == "engine_google"|
variable == "handsearch"|
variable == "experts"|
variable == "backward"|
variable == "forward"|
variable == "reviews"|
variable == "update_search"|
variable == "kugley")
#Conduct variables for no IS
#Conduct variables for IS coauthor
conduct_nois <- none_impact %>% filter(variable == "boolean"|
variable == "subhead"|
variable == "keyword_var"|
variable == "phrase"|
variable == "syntax"|
variable == "free_gs"|
variable == "engine_google"|
variable == "handsearch"|
variable == "experts"|
variable == "backward"|
variable == "forward"|
variable == "reviews"|
variable == "update_search"|
variable == "kugley")
#Merge all three dataframes
conduct_is_table1 <- merge(conduct_nois, conduct_mention, by = "variable", all = TRUE)
conduct_is_table <- merge(conduct_is_table1, conduct_coauth, by = "variable", all = TRUE)
#Rename variable names for table
conduct_is_table_rename <- conduct_is_table %>%
mutate(variable = case_when(
variable == "backward" ~ "Backward citation searching conducted",
variable == "boolean" ~ "Boolean operators used correctly",
variable == "engine_google" ~ "Google searched",
variable == "experts" ~ "Experts contacted",
variable == "forward" ~ "Forward citation searching conducted",
variable == "free_gs" ~ "Google Scholar searched",
variable == "handsearch" ~ "Handsearches conducted",
variable == "keyword_var" ~ "Keyword variants used",
variable == "kugley" ~ "Kugley et al. (2017) guidance cited",
variable == "phrase" ~ "Phrase searching used correctly",
variable == "reviews" ~ "References of related reviews searched",
variable == "subhead" ~ "Database subj heading/thesauri used",
variable == "syntax" ~ "Database syntax used correctly",
variable == "update_search" ~ "Search updated prior to publication"
))
#Reorder with custom order
conduct_custom_order <- c("Boolean operators used correctly","Database subj heading/thesauri used","Keyword variants used",
"Phrase searching used correctly", "Database syntax used correctly", "Google Scholar searched",
"Google searched", "Handsearches conducted","Experts contacted",
"Backward citation searching conducted", "Forward citation searching conducted",
"References of related reviews searched", "Search updated prior to publication", "Kugley et al. (2017) guidance cited")
conduct_is_table_rename <- conduct_is_table_rename %>%
mutate(variable = factor(variable, levels = conduct_custom_order)) %>%
arrange(variable)
write_csv(conduct_is_table_rename, here("./data_outputs/ccmethods_isinvolve_conduct_table.csv"))
conduct_is_chart_df <- conduct_is_table[, c(1,3, 5, 7)]
#Transpose to long format grouping percentage columns by IS involvement
conduct_is_chart_long <- conduct_is_chart_df %>%
pivot_longer(cols = c(percentage.x, percentage.y, percentage),
names_to = "group",
values_to = "percentage")
#Rename group names
conduct_is_chart_long <- conduct_is_chart_long %>%
mutate(group = case_when(
group == "percentage.x" ~ "No IS",
group == "percentage.y" ~ "IS consulted",
group == "percentage" ~ "IS co-author"))
conduct_is_chart_long <- conduct_is_chart_long %>%
mutate(group = factor(group, levels = c("No IS", "IS consulted", "IS co-author")))
#Rename variable names for legend
conduct_is_chart_renamed <- conduct_is_chart_long %>%
mutate(variable = case_when(
variable == "backward" ~ "Backward citation search",
variable == "boolean" ~ "Boolean operators correct",
variable == "engine_google" ~ "Google searched",
variable == "experts" ~ "Experts contacted",
variable == "forward" ~ "Forward citation search",
variable == "free_gs" ~ "Google Scholar searched",
variable == "handsearch" ~ "Handsearches conducted",
variable == "keyword_var" ~ "Keyword variants used",
variable == "kugley" ~ "Kugley et al. (2017) guidance cited",
variable == "phrase" ~ "Phrase searching correct",
variable == "reviews" ~ "Related reviews searched",
variable == "subhead" ~ "Database subj headings used",
variable == "syntax" ~ "Database syntax correct",
variable == "update_search" ~ "Search updated"
))
#Reorder so that the legend list matches the order of values in the No IS column
custom_order_iscd <- c("Backward citation search", "Boolean operators correct", "Keyword variants used", "Phrase searching correct", "Experts contacted", "Related reviews searched", "Database syntax correct", "Google Scholar searched", "Database subj headings used", "Handsearches conducted", "Forward citation search", "Google searched", "Search updated", "Kugley et al. (2017) guidance cited")
conduct_is_chart_renamed$variable <- factor(conduct_is_chart_renamed$variable, levels = custom_order_iscd)
#Plot change in percentage over groups
#Create distinguishable palette for 14 variables
my_palette_14 <- c25 <- c(
"dodgerblue2", "#E31A1C", # red
"green4",
"#6A3D9A", # purple
"#FF7F00", # orange
"black", "gold1", "orchid1", "deeppink1", "blue1",
"darkturquoise", "green1", "yellow3", "brown"
)
pt_conduct_is <- ggplot(conduct_is_chart_renamed, aes(x = group, y = percentage, color = variable, group = variable)) +
geom_line() +
geom_point() +
labs(title = "",
x = "",
y = "Percent of reviews",
color = "Variable") +
theme_minimal() +
theme(legend.title=element_blank()) +
scale_color_manual(values = my_palette_14)
ggsave(here("./plots/fig7a.png"), plot = pt_conduct_is, width = 6, height = 4, units = "in", dpi = 300)
library(tidyverse)
library(ggplot2)
library(here)
#Import data
ccmethods_data <- read.csv(here("./data/CC-methods-data-extraction-final-20240222-clean-recode.csv"), na = "NA")
ccmethods_data <- ccmethods_data %>%
mutate(strategy_rep = case_when(strategy_one == "no" | strategy_one == "unclear" ~ "None",
strategy_one == "yes" & strategy_all == "no" ~ "Partial",
strategy_one == "yes" & strategy_all == "unclear" ~ "Partial",
strategy_all == "yes" ~ "Full"))
ccmethods_data$db_list_gp <- factor(ccmethods_data$db_list) #Convert to factor
levels(ccmethods_data$db_list_gp) #Print levels
levels(ccmethods_data$db_list_gp) <- c("some", "some", "all") #Recode to new values
levels(ccmethods_data$db_list_gp) #Print new levels
subset_report <- ccmethods_data %>%
select(pub_year, grey_url, date_searches, db_platform, strategy_all, grey_list,
grey_search, forward_method, refman_software, deduplicate, num_records,
db_list, update_search)
subset_report$grey_url <- recode_factor(subset_report$grey_url,
"all" = "yes",
"none" = "no",
"some" = "partial")
subset_report$db_platform <- recode_factor(subset_report$db_platform,
"all" = "yes",
"none" = "no",
"some" = "partial")
subset_report$db_list <- recode_factor(subset_report$db_list,
"Partially with some umbrella databases given with no detail" = "partial",
"Partially with some generic platforms given with no detail" = "partial",
"Yes: All databases including sub-databases of umbrella databases" = "yes")
subset_report$grey_list <- recode_factor(subset_report$grey_list,
"all" = "yes",
"none" = "no",
"some" = "partial")
subset_report$date_searches <- recode_factor(subset_report$date_searches,
"General date range of searches given" = "partial",
"No dates given" = "no",
"Specific dates of each search given" = "yes")
subset_report$grey_search <- recode_factor(subset_report$grey_search,
"General grey literature approach stated in text only" = "partial",
"Some exact search strategies reported" = "partial",
"Other" = "partial",
"No reporting of how grey literature was searched" = "no",
"All exact search strategies reported" = "yes")
# Reshape the dataframe from wide to long format
report_long <- subset_report %>%
pivot_longer(cols = -pub_year, names_to = "variable", values_to = "value")
# Calculate the percentage of 'yes' values for each variable and year
result_report_df <- report_long %>%
group_by(pub_year, variable) %>%
summarize(percent = mean(value == "yes", na.rm = TRUE) * 100)
result_report_df$percent <- round(result_report_df$percent, 1)
View(result_report_df)
result_report_df <- result_report_df %>%
mutate(variable =
forcats::fct_recode(variable,
"Search updated" = "update_search",
"All databases" = "db_list",
"Database platform" = "db_platform",
"Deduplication method" = "deduplicate",
"Forward citation method" = "forward_method",
"Grey lit sources" = "grey_list",
"Grey lit searches" = "grey_search",
"Website URLs" = "grey_url",
"Number of results" = "num_records",
"Ref Management Software"= "refman_software",
"All search strategies" = "strategy_all",
"Search date"= "date_searches"))
result_report_df <- result_report_df %>%
mutate(variable = factor(variable,
levels = c("All databases", "Database platform", "Grey lit sources",
"Website URLs", "All search strategies", "Grey lit searches",
"Search date", "Number of results", "Search updated",
"Forward citation method", "Deduplication method", "Ref Management Software")))
pt_time_report <- ggplot(result_report_df, aes(x = pub_year, y = percent)) +
geom_line() +
facet_wrap(~ variable, ncol = 3, scales="fixed") +
labs(x = "Year", y = "Percent") +
geom_area(fill = "grey87") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid.minor = element_blank()) +
scale_y_continuous(limits = c(0, 100))
pt_time_report
ggsave(here("./plots/fig4b.png"), plot = pt_time_report, width = 7, height = 6, units = "in", dpi = 300)
